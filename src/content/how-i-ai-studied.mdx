---
title: "Как я AI с помощью AI учил"
publishedAt: "2023-02-02"
summary: "Вы полюбому слышали про нейронки, которые там любые картинки рисуют и на любую тему подискутировать способны. Речь о Midjourney и ChatGPT. Собственно я решился научиться разрабатывать искусственный интеллект с помощью того самого любителя поговорить, с ChatGPT"
image: "/images/how-i-ai-studied/cover.png"
---

<BlogHorizontalImage url="/images/how-i-ai-studied/cover.png" alt="AI robot shows examples on the blackboard how to learn AI" />

## Оглавление

1. [Знакомство](#знакомство)
2. [Выбор проекта](#выбор-проекта)
3. [Практика](#практика)

### Знакомство

Недолго думая, я подрубил VPNчик и зашёл на [сайтик OpenAI](https://openai.com/blog/chatgpt/), почитал чо как, ну и зашёл непосредственно в интерфейс для работы с самой нейронкой.
В любой IT сфере есть roadmap, пройдя который ты пройдёшь путь от нуля до профессионала. Собственно именно это я и запросил у GPT:

> Show the roadmap to learn machine learning

_"Я не знаю английского, можно не на буржуйском с GPT общаться?" - Да, с нейронкой можно на русском, но такое себе_

Нейронка посмеялась с моей тавтологии, но всё же ответила мне. Список оказался примерно таким:

1. Получи базовые навыки в программировании и выучи хотя бы 1 язык (желательно Python)
2. Научись базовой статистике и теории вероятности, так как они важны для понятия многих алгоритмов
3. Разберись в разных типах машинного обучения: обучение с учителем (supervised), без учителя (unsupervised), с подкреплением (reinforcement)
4. Разберись в базовых алгоритмах, таких как: линейная регрессия, алгоритм k-ближайших соседей, дерево решений и нейронные сети
5. Практикуйся, применяя полученные знания к реальным жизненным проблемам, используя библиотеки вроде scikit-learn и TensorFlow
6. Работай, набивай портфолио, блаблабла...

Ну первый пункт у меня благо выполнен, не зря 4 года ради одной бумажки провтухал.

Второй пунктик уже вызвал у меня немного отвращения, ибо ТВиМС (теория вероятности и мат. статистика) крайне неприятный предмет для изучения. Однако я добросовестно взял волю в кулак и прошёлся по базовому обучающему курсу, можете не переживать.

Опять же опущу моменты, связанные с математикой. Для изучения машинного обучения, как оказалось, надо бы хорошенько её знать. Тут меня флешбекнуло во времена школы и студенчества, ибо я даже линейное уравнение с двумя неизвестными решить не смог. Что тут о дифференцировании говорить.

Перейдём к интересному, к 3 пункту - что за типы машинного обучения нас ожидают. Делаю запрос:

> Give me extended explanation of supervised, unsupervised and reinforcement learning types

Буду в основном опираться на английскую терминологию, ибо на русском уши вянут от названий этих. Еще добавлю, что нейросеть отвечает мне полностью на английском. Перевожу в прямом эфире. Не удивляйтесь, если смысл покажется вам искажённым.

## Supervised (с учителем):

Supervised обучение - это такой алгоритм машинного обучения, который тренирует модель используя маркированные данные, где известен конечный и желаемый результат. Модель обучается предсказывать конечный результат, опираясь на входные данные. Модель оценивается на основе точности её предсказаний, и любые ошибки используются для регулирования параметров модели.

Примеры подобного типа обучения:
- регрессия (предсказание числового значения)
- классификация (предсказание категории)
- прогнозирование временных рядов (предсказание будущих значений, основываясь на результатах в прошлом).

## Unsupervised (без учителя):

Unsupervised обучение - это такой алгоритм машинного обучения, который тренирует модель используя немаркированные данные. Цель такого обучения - найти паттерны или структуры в данных, нежели предсказать конкретное значение. Модель не обуславливают тем, какой результат она должна выдать. Её необходимо найти паттерны и взаимосвязи самостоятельно.

Примеры подобного типа обучения:
- кластеризация (группирование данных по похожим признакам)
- снижение размерности _(dimensionality reduction)_ (уменьшение числа переменных путём получения главных переменных)
- поиск аномалий (идентификация посторонних объектов в данных).

## Reinforcement (с подкреплением):

Reinforcement обучение - это такой алгоритм машинного обучения, который тренирует модель используя систему вознаграждений. Модель получает награды или штрафы, в зависимости от её действий, и цель в данном случае - максимизировать конечную награду через неопределённое время. Такой тип обучения часто используется в системах поддержки принятия решений, где модели необходимо научиться взаимодействовать с окружающей средой и выбирать те решения, которые буду приводить к оптимальному результату.

Примеры подобного типа обучения:
- игра в видеоигры (где модель вознаграждается за победы и получает штрафы за поражение)
- контроллирование роботов (где модель учится выполнять поставленные задачи)
- торговля финансовыми активами (где модель учится как принимать инвестиционные решения, основываясь на рыночных трендах)

Отлично, мы поняли какие типы машинного обучения существуют. Перейдём к четвертому пункту, непосредственно к самим алгоритмам. Делаю поочерёдно запросы:

> explain how linear regression works

Линейная регрессия - алгоритм обучения с учителем, использующийся для предсказания непрерывных значений (таких как цены, температуры или веса) основываясь на одном или нескольких признаках (входных параметрах). Это предполагает что существует линейная зависимость между входными параметрами и целевым значением, и он ищет наиболее подходящую **линию**, представляющую данную взаимосвязь.

**Линия** представлена математически формулой `y = b0 + b1x1 + b2x2 + ... + bnxn`, где y - конечное(целевое) значение, `b0` - сдвиг по оси y, `b1, b2, ..., bn` - коэффициенты входящих параметров `x1, x2, ..., xn`. Эти коэффициенты определяют наклон линии, который представляет собой силу и направление взаимосвязи между каждым входным параметром и целевым значением.

Чтобы найти наиболее подходящую линию, алгоритм использует метод наименьших квадратов, который минимизирует сумму квадратов разностей между фактическими целевыми значениями и прогнозируемыми значениями на основе уравнения линии. Это приводит к оптимизации коэффициентов, которые можно использовать для прогнозирования новых, невидимых данных.

Линейная регрессия может применяться к данным с одним или несколькими признаками и может быть расширена до полиномиальной или множественной регрессии, где взаимосвязь между целевым значением и входными параметрами представлена ​​​​более сложным уравнением.

> explain how k-nearest neighbors work

Метод K-ближайших соседей _(K-Nearest Neighbors)_ - это unsupervised алгоритм обучения, использующийся для классификации и регрессии. Метод основан на идеи поиска ближайших точек данных (соседей) в функциональном пространстве, чтобы делать предсказания.

В данном методе, каждая точка данных представлена в виде списка признаков (входящих значений), и алгоритм ищет k-число точек данных, которые близки к новой точке данных для того, чтобы классифицировать её.

Значение переменной `k` - гиперпараметр, который пользователь может изменять, и он определяет количество соседей, которые рассматриваются для предсказания. Чем больше число `k`, тем более смягченным будет результат, в то время как наименьшее число даст более сложный и "туповатый" результат.

> explain how decision tree works

Дерево решений используется в supervised обучении в качестве решения проблем регрессии и классификации. Дерево состоит из внутренних узлов, которые представляют решения, основываясь на входных параметрах; и из листовых узлов, которые представляют конечное значение.

Алгоритм начинается с корня дерева и, основываясь на входных признаках, следует по пути через дерево к соответствующему конечному узлу. Внутренние узлы разделяются на основе признака, обеспечивающего наибольший прирост информации, который измеряет снижение энтропии или загрязнения данных после разделения. Разбиения рекурсивно повторяются для результирующих подгрупп до тех пор, пока не будет достигнут критерий остановки, такой как максимальная глубина или минимальное количество выборок в листовом узле.

> explain how neural networks work

Нейронные сети - тип машинного обучения, вдохновлённый структурой и функционалом человеческого мозга. Они используются для решения и supervised задач, и unsupervised: классификации изображения, распрознавание речи, обработка ествественного языка (тут спрятался наш GPT)

Нейронная сеть состоит из входного слоя, одного или нескольких скрытых слоев и выходного слоя. Каждый слой состоит из узлов (также известных как нейроны), которые получают входные данные от предыдущего слоя, обрабатывают входные данные с помощью нелинейной функции активации и передают выходные данные следующему слою.

При supervised обучении входные признаки передаются через сеть, а выходные данные конечного слоя сравниваются с целевыми значениями. Разница между фактическими и прогнозируемыми значениями используется для обновления коэффициентов входных параметров в сети, чтобы сеть могла научиться делать более точные прогнозы. Этот процесс повторяется несколько раз, пока сеть не достигнет удовлетворительного уровня точности обучающих данных.

***

### Выбор проекта

Что ж, по логике ChatGPT, мы прошли вводный курс теории, теперь готовы непосредственно к практике.

В программировании в качестве первой программы при обучении принято создавать так называемый _"Hello world"_. Данная программа просто выводил в консоль, либо на экран сообщение "Привет, мир!"

Спрошу у нейронки, какая программа является образом _"Hello world"_ в мире машинного обучения:

> What are "Hello world" starting projects in machine learning?

Стартовые проекты "Hello world" в мире машинного обучения созданы, чтобы помочь начинающим начать обучение. В основном эти проекты маленькие, прямолинейные и сфокусированны на конкретных задачах, таких как:

1. Классификация ирисов: этот проект включает в себя использование алгоритмов для классификации ирисов основываясь на длине их листьев, их ширине. Это классический пример supervised классификации.
2. Распознание рукописных цифр: этот проект включает в себя использование алгоритмов для распознавания рукописных цифр из набора данных "MNIST". Это так же пример supervised классификации.
3. Линейная регрессия: линейная регрессия в данном проекте используется для предсказания непрерывного значения, например: цена дома, основанная на одном или нескольких входных значениях.
4. Кластеризация: алгоритмы кластеризации используются для группировки похожих типов данных вместе, основываясь на их параметрах. Это unsupervised пример.

Эти проекты являются хорошей отправной точкой для начинающих, чтобы получить практический опыт машинного обучения, понять основные концепции и научиться использовать различные алгоритмы и библиотеки.

Окей, в этом разобрались. Для себя лично выделил линейную регрессию, так как с точки зрения математики довольно таки просто и понятно. Спросим какие именно проблемы можно решить используя данный подход:

> What kinds of projects are better for starting developing linear regression?

Виды проектов для начала разработки:

- Прогнозирование цен на жилье: используйте линейную регрессию для прогнозирования цен на дома на основе таких характеристик, как площадь, количество спален и местоположение.
- Прогнозирование продаж: используйте линейную регрессию для прогнозирования продаж на основе таких факторов, как расходы на рекламу, сезонность и экономические показатели.
- Прогнозирование цен на акции: используйте линейную регрессию для прогнозирования цен на акции на основе исторических данных и экономических показателей.

Эти проекты просты и понятны и служат хорошей отправной точкой для развития ваших навыков в области линейной регрессии. Они помогут вам понять основы линейной регрессии и способы ее реализации на практике.

Тут меня сразу заинтересовал третий пункт - сам увлекаюсь финансами и торгую криптовалютой, поэтому почему бы не совместить полезное с приятным? Спрашиваю как именно начать разрабатывать это:

> Explain all steps for developing linear regression for predicting stock prices

Но GPT после такого запроса сломался и дал кучу бесполезной информации, так что я непосредственно перешёл к делу.

***

### Практика

Предскажим цену биткоина с помощью ИИ? Тогда за дело!

> implement linear regression for predicting btc/usdt prices in python

1. Загрузите данные: в этом примере мы будем использовать исторические цены BTC/USDT, которые можно получить на биржах криптовалюты, таких как Binance, Coinbase или Kraken. Вы можете загрузить данные, используя следующий код:

```python
import pandas as pd

df = pd.read_csv('btc_usdt_data.csv')
X = df[['open', 'high', 'low', 'volume']].values
y = df['close'].values
```

2. Нормализация данных. Чтобы повысить производительность модели, рекомендуется нормализовать данные. Вы можете сделать это, используя класс StandardScaler из scikit-learn:

```python
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
X = scaler.fit_transform(X)
y = scaler.fit_transform(y.reshape(-1, 1))
```

3. Разделите данные: разделите данные на наборы для обучения и тестирования, используя функцию train_test_split из scikit-learn:
```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
```

4. Обучите модель: Обучите модель линейной регрессии, используя обучающие данные:

```python
from sklearn.linear_model import LinearRegression

model = LinearRegression()
model.fit(X_train, y_train)
```

5. Оцените модель: Оцените производительность модели, используя тестовые данные:

```python
from sklearn.metrics import mean_squared_error

y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
print('MSE: {}'.format(mse))
```

Этот код должен обучать модель линейной регрессии для прогнозирования цен BTC/USDT и оценивать ее эффективность с использованием среднеквадратичной ошибки. Обратите внимание, что вам нужно будет получить исторические цены BTC/USDT на бирже криптовалют и сохранить их в виде файла CSV со столбцами для цен открытия, максимума, минимума, объема и закрытия.

> Well i have trained model. How do i predict prices? Write code using python

После того, как вы обучили модель линейной регрессии прогнозировать цены BTC/USDT, вы можете использовать ее для прогнозирования новых данных, используя метод модели «predict()». Вот пример того, как использовать обученную модель для прогнозирования новых данных в Python:

```python
import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression

# Load the data
df = pd.read_csv('new_data.csv')
X_new = df[['open', 'high', 'low', 'volume']].values

# Normalize the data
scaler = StandardScaler()
X_new = scaler.fit_transform(X_new)

# Load the trained model
model = LinearRegression()
model.load('model.pkl')

# Make predictions on new data
y_new = model.predict(X_new)

# Denormalize the predictions
y_new = scaler.inverse_transform(y_new)

# Print the predictions
print(y_new)
```
В этом коде new_data.csv — это файл CSV, содержащий цены открытия, максимума, минимума и объема BTC/USDT для новых данных, на основе которых вы хотите делать прогнозы. Код нормализует новые данные, используя тот же скейлер, который использовался для нормализации обучающих данных, загружает обученную модель из файла (model.pkl), делает прогнозы для новых данных, используя метод predict(), денормализует прогнозы, используя тот же скейлер, и печатает прогнозы.

***

## Полезное чтиво для твоего мозга

[Лонгрид про машинное обучение (большинство картинок оттуда)](https://vas3k.ru/blog/machine_learning/)